var PageJs=new Class.create;PageJs.prototype=Object.extend(new BackEndPageJs,{uploaderDivId:"",_getTitleRowData:function(){return{name:"Name",code:"Code",active:"Active?"}},setHTMLIds:function(e,i){return this.uploaderContainerId=e,this.uploaderDivId=i,this},_loadUploader:function(){var e={};return e.me=this,e.fileSizeLimit=5e8,e.uploader=jQuery("#fileupload").fileupload({url:"/fileUploader/",type:"POST",dataType:"JSON",formAcceptCharset:"utf-8",maxFileSize:e.fileSizeLimit,add:function(i,t){e.uploadErrors=[],e.acceptFileTypes=/^video\/(mp4)$/i,console.debug(t),t.originalFiles&&1!=t.originalFiles.length&&e.me.showModalBox("Invalid File Quantity","Only one file per upload"),t.originalFiles[0].type.length&&!e.acceptFileTypes.test(t.originalFiles[0].type)&&e.me.showModalBox("Invalid File Type","Not an accepted file type"),t.originalFiles[0].size&&t.originalFiles[0].size>e.fileSizeLimit&&e.me.showModalBox("Invalid File Size","Filesize is too big"),0==e.uploadErrors.length&&t.submit()},done:function(i,t){console.debug(t),$(e.me.uploaderDivId).hide(),$(e.me.uploaderContainerId).insert({bottom:new Element("video",{width:320,height:240,controls:!0}).insert({bottom:new Element("source",{src:t._response.result.asset.url,type:t._response.result.asset.mimeType})})})},fail:function(i,t){e.message="",jQuery.each(t.messages,function(i,t){e.me.showModalBox("Error",'<p style="color: red;">Upload file error: '+t+'<i class="elusive-remove" style="padding-left:10px;"/></p>')})},progressall:function(i,t){e.progress=parseInt(t.loaded/t.total*100,10),jQuery("#progress .bar").css("width",e.progress+"%")}}),e.me},getUploaderDiv:function(){var e={};return e.me=this,e.newDiv=new Element("div",{"class":"uploader",id:e.me.uploaderDivId}).insert({bottom:new Element("input",{id:"fileupload",type:"file",name:"file"})}).insert({bottom:new Element("div",{id:"progress",style:"width: 100%; border: 1px solid black; height: 10px;"}).insert({bottom:new Element("div",{"class":"bar",style:"width: 1%; height: 100%; background-color: blue;"})})}),e.newDiv},init:function(){var e={};return e.me=this,$(e.me.uploaderContainerId).insert({bottom:new Element("div")}).insert({bottom:new Element("h4").update("New Video")}).insert({bottom:e.me.getUploaderDiv()}),e.me._loadUploader(),this}});
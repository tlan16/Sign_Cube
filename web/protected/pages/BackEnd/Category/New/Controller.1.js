var PageJs=new Class.create;PageJs.prototype=Object.extend(new BackEndPageJs,{_getTitleRowData:function(){return{name:"Name",code:"Code",active:"Active?"}},_htmlIds:{},_language:null,_items:{},setHTMLIds:function(e,t){var n={};return n.me=this,n.me._htmlIds.itemDiv=e,n.me._htmlIds.searchPanel=t,this},_getLanguageInfoPanel:function(){var e={};return e.me=this,e.language=e.me._language,e.newDiv=new Element("div",{"class":"panel panel-default"}).insert({bottom:new Element("div",{"class":"panel-heading"}).insert({bottom:new Element("div",{"class":"row"}).insert({bottom:new Element("div",{"class":"col-sm-12"}).insert({bottom:new Element("p").update("Creating Category for: <b>"+e.language.name+"</b>("+e.language.code+") ")})})})}),e.newDiv},_getCategoryRow:function(e,t){var n={};return n.me=this,n.isTitle=t||!1,n.tag=n.isTitle===!0?"th":"td",n.row=new Element("tr",{"class":n.isTitle===!0?"":"item_row order-item-row"}).store("data",e).insert({bottom:new Element(n.tag,{"class":"name"}).insert({bottom:e.category.name})}).insert({bottom:new Element(n.tag,{"class":"language"}).insert({bottom:e.language.name})}).insert({bottom:new Element(n.tag,{"class":"languageId hidden"}).insert({bottom:e.language.id?e.language.id:""})}).insert({bottom:new Element(n.tag,{"class":"btns  col-xs-1"}).update(e.btns?e.btns:"")}),n.row.down(".name").writeAttribute("colspan",2),n.row},_addNewCategoryRow:function(e){var t={};return t.me=this,t.btn=e,t.inputEl=e.up(".new-order-item-input").down('[new-order-item="category"]'),t.me._signRandID(t.inputEl),t.row=e.up(".new-order-item-input"),t.data=t.me._collectFormData(t.row,"new-order-item"),null!==t.data?(t.me.postAjax(t.me.getCallbackId("saveItem"),{item:t.data},{onLoading:function(){jQuery("#"+t.inputEl.id).button("loading")},onSuccess:function(e,n){try{if(t.result=t.me.getResp(n,!1,!0),!t.result||!t.result.item)return;t.newRow=t.me._getCategoryRow(t.result.item,!1),$(t.me._htmlIds.newOrderItemInput).insert({after:t.newRow}),$(t.me._htmlIds.itemDiv).down("[new-order-item=category]").focus(),$(t.me._htmlIds.itemDiv).down("[new-order-item=category]").select()}catch(a){t.me.showModalBox('<span class="text-danger">ERROR:</span>',a,!0)}},onComplete:function(){jQuery("#"+t.inputEl.id).button("reset")}}),t.me):void 0},_getNewCategoryRow:function(){var e={};return e.me=this,e.data={category:{name:e.me._getFormGroup(null,new Element("input",{"class":"input-sm","new-order-item":"category",required:"Required!",value:""}).observe("click",function(){$(this).select()}).observe("keydown",function(t){e.me.keydown(t,function(){$(e.me._htmlIds.newOrderItemInput).down(".btn.btn-save-new-cat").click()})}))},language:{name:e.me._getFormGroup(null,new Element("input",{"class":"input-sm","new-order-item":"language",disabled:!0,value:e.me._language.name})),id:e.me._getFormGroup(null,new Element("input",{"class":"input-sm","new-order-item":"languageId",disabled:!0,value:e.me._language.id}))},btns:new Element("span",{"class":"btn-group btn-group-sm pull-right"}).insert({bottom:new Element("span",{"class":"btn btn-primary btn-save-new-cat"}).insert({bottom:new Element("span",{"class":" glyphicon glyphicon-floppy-saved"})}).observe("click",function(){e.me._addNewCategoryRow($(this))})}).insert({bottom:new Element("span",{"class":"btn btn-default"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-floppy-remove"})}).observe("click",function(){confirm("You about to clear this entry. All input data for this entry will be lost.\n\nContinue?")&&(e.newRow=e.me._getNewCategoryRow(),e.currentRow=$(this).up(".new-order-item-input"),e.currentRow.getElementsBySelector(".form-group.has-error .form-control").each(function(e){$(e).retrieve("clearErrFunc")()}),e.currentRow.replace(e.newRow),e.newRow.down("[new-order-item=category]").focus(),e.newRow.down("[new-order-item=category]").select())})})},e.me._htmlIds.newOrderItemInput="new-order-item-input",e.me._getCategoryRow(e.data,!1).writeAttribute("id",e.me._htmlIds.newOrderItemInput).addClassName("new-order-item-input info").removeClassName("order-item-row")},getItems:function(e,t){var n={};return n.me=this,n.reset=e||!1,n.resultDiv=$(n.me.resultDivId),n.reset===!0&&(n.me._pagination.pageNo=1),n.me._pagination.pageSize=t||n.me._pagination.pageSize,n.me.postAjax(n.me.getCallbackId("getItems"),{pagination:n.me._pagination,language:n.me._language},{onLoading:function(){},onSuccess:function(e,t){try{if(n.result=n.me.getResp(t,!1,!0),!n.result)return;n.me._items=n.result,n.newDiv=n.me._getViewOfCategory(),$(n.me._htmlIds.itemDiv).update(n.newDiv),n.newDiv.down("[new-order-item=category]").focus(),n.newDiv.down("[new-order-item=category]").select()}catch(a){n.resultDiv.insert({bottom:n.me.getAlertBox("Error",a).addClassName("alert-danger")})}},onComplete:function(){}}),n.me},_getPartsTable:function(){var e={};return e.me=this,e.productListDiv=new Element("table",{"class":"table table-hover table-condensed category_change_details_table"}).insert({bottom:e.me._getCategoryRow({category:{name:"Name"},language:{name:"Language"}},!0).wrap(new Element("thead"))}),e.productListDiv.insert({bottom:e.tbody=new Element("tbody",{style:"border: 3px #ccc solid;"}).insert({bottom:e.me._getNewCategoryRow()})}),e.me._items.items.each(function(t){e.data={category:t,language:e.me._language},e.tbody.insert({bottom:e.me._getCategoryRow(e.data)})}),new Element("div",{"class":"panel panel-info"}).insert({bottom:new Element("div",{"class":"panel-body table-responsive"}).insert({bottom:e.productListDiv})})},_getViewOfCategory:function(){var e={};return e.me=this,e.newDiv=new Element("div").insert({bottom:new Element("div",{"class":"row"}).insert({bottom:new Element("div",{"class":"col-sm-12"}).update(e.me._getLanguageInfoPanel())})}).insert({bottom:new Element("div",{"class":"row"}).insert({bottom:new Element("div",{"class":"col-sm-12"}).update(e.me._getPartsTable())})}),e.newDiv},selectLanguage:function(e){var t={};return t.me=this,t.me._language=e,t.me.getItems(),t.me},_getLanguageRow:function(e,t){var n={};return n.me=this,n.isTitle=t||!1,n.tag=n.isTitle===!0?"th":"td",n.newDiv=new Element("tr",{"class":(n.isTitle===!0?"item_top_row":"btn-hide-row item_row")+(0==e.active?" danger":""),item_id:n.isTitle===!0?"":e.id}).store("data",e).insert({bottom:new Element(n.tag).insert({bottom:n.isTitle===!0?"&nbsp;":new Element("span",{"class":"btn btn-primary btn-xs"}).update("select").observe("click",function(){n.me.selectLanguage(e)})})}).insert({bottom:new Element(n.tag).update(e.name)}).insert({bottom:new Element(n.tag).update(e.code)}).insert({bottom:new Element(n.tag).insert({bottom:n.isTitle===!0?e.active:new Element("input",{type:"checkbox",disabled:!0,checked:e.active})})}),n.newDiv},_searchLanguage:function(e){var t={};return t.me=this,t.searchTxt=$F(e).strip(),t.searchPanel=$(e).up("#"+t.me._htmlIds.searchPanel),t.me.postAjax(t.me.getCallbackId("searchLanguage"),{searchTxt:t.searchTxt},{onLoading:function(){$(t.searchPanel).down(".list-div")&&$(t.searchPanel).down(".list-div").remove(),$(t.searchPanel).insert({bottom:new Element("div",{"class":"panel-body"}).update(t.me.getLoadingImg())})},onSuccess:function(e,n){$(t.searchPanel).down(".panel-body")&&$(t.searchPanel).down(".panel-body").remove();try{if(t.result=t.me.getResp(n,!1,!0),!t.result||!t.result.items)return;$(t.searchPanel).insert({bottom:new Element("small",{"class":"table-responsive list-div"}).insert({bottom:new Element("table",{"class":"table table-hover table-condensed"}).insert({bottom:new Element("thead").insert({bottom:t.me._getLanguageRow({name:"Name",code:"Code",active:"Active?"},!0)})}).insert({bottom:t.listDiv=new Element("tbody")})})}),t.result.items.each(function(e){t.listDiv.insert({bottom:t.me._getLanguageRow(e)})})}catch(a){$(t.searchPanel).insert({bottom:new Element("div",{"class":"panel-body"}).update(t.me.getAlertBox("ERROR",a).addClassName("alert-danger"))})}}}),t.me},_getLanguageListPanel:function(){var e={};return e.me=this,e.newDiv=new Element("div",{id:e.me._htmlIds.searchPanel,"class":"panel panel-default search-panel"}).insert({bottom:new Element("div",{"class":"panel-heading form-inline"}).insert({bottom:new Element("strong").update("Creating a new category for language: ")}).insert({bottom:new Element("span",{"class":"input-group col-sm-6"}).insert({bottom:new Element("input",{"class":"form-control search-txt init-focus",placeholder:"Language name or code"}).observe("keydown",function(t){return e.txtBox=this,e.me.keydown(t,function(){e.txtBox.up("#"+pageJs._htmlIds.searchPanel).down(".search-btn").click()}),!1})}).insert({bottom:new Element("span",{"class":"input-group-btn search-btn"}).insert({bottom:new Element("span",{"class":" btn btn-primary"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-search"})})}).observe("click",function(){e.btn=this,e.txtBox=$(e.me._htmlIds.searchPanel).down(".search-txt"),$F(e.txtBox).blank()?$(e.me._htmlIds.searchPanel).down(".table tbody")&&($(e.me._htmlIds.searchPanel).down(".table tbody").innerHTML=null):e.me._searchLanguage(e.txtBox)})})}).insert({bottom:new Element("span",{"class":"btn btn-success pull-right btn-sm btn-danger"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-remove"})}).observe("click",function(){$(e.me._htmlIds.searchPanel).down(".search-txt").clear().focus(),$(e.me._htmlIds.searchPanel).down(".table tbody").innerHTML=null})})}),e.newDiv},init:function(e){var t={};return t.me=this,e?(t.me.selectLanguage(e),t.me._language=e):$(t.me._htmlIds.itemDiv).update(t.me._getLanguageListPanel()),$$(".init-focus").size()>0&&$$(".init-focus").first().focus(),t.me}});